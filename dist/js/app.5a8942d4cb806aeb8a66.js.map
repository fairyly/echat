{"version":3,"sources":["webpack:///js/app.5a8942d4cb806aeb8a66.js","webpack:///./src/wilddog/index.js","webpack:///./src/router/index.js","webpack:///./src/App.vue?35a7","webpack:///App.vue","webpack:///chat-view.vue","webpack:///login.vue","webpack:///room.vue","webpack:///./src/common/getApp.js","webpack:///./src/main.js","webpack:///./src/components/chat-view.vue?db57","webpack:///./src/pages/login.vue?5912","webpack:///./src/pages/room.vue?c0ab","webpack:///./src/pages/login.vue?bc99","webpack:///./src/pages/room.vue?62bc","webpack:///./src/App.vue?74c3","webpack:///./src/components/chat-view.vue?01f9"],"names":["webpackJsonp","module","__webpack_exports__","__webpack_require__","__WEBPACK_IMPORTED_MODULE_0_wilddog__","__WEBPACK_IMPORTED_MODULE_0_wilddog___default","n","config","authDomain","syncURL","a","initializeApp","Ref","sync","__WEBPACK_IMPORTED_MODULE_0_vue__","__WEBPACK_IMPORTED_MODULE_1_vue_router__","__WEBPACK_IMPORTED_MODULE_2__pages_login_vue__","__WEBPACK_IMPORTED_MODULE_2__pages_login_vue___default","__WEBPACK_IMPORTED_MODULE_3__pages_room_vue__","__WEBPACK_IMPORTED_MODULE_3__pages_room_vue___default","use","routes","path","name","component","exports","Component","Object","defineProperty","value","data","room","nickname","props","stream","width","type","Number","default","height","computed","src","this","URL","createObjectURL","methods","loadedmetadataHandler","console","log","label","getAudioTracks","getVideoTracks","__WEBPACK_IMPORTED_MODULE_0__wilddog_index_js__","join","_this","alert","app","$root","$children","Math","random","toString","substr","child","set","Date","now","err","$router","push","errHandler","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify__","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default","__WEBPACK_IMPORTED_MODULE_1__common_getApp_js__","__WEBPACK_IMPORTED_MODULE_2__wilddog_index_js__","__WEBPACK_IMPORTED_MODULE_3__components_chat_view_vue__","__WEBPACK_IMPORTED_MODULE_3__components_chat_view_vue___default","ICE_SERVERS","iceServers","url","mixins","dog","peer","selfStream","userStream","targetNickname","createLocalStream","navigator","mediaDevices","getUserMedia","audio","video","then","createPeer","remoteUserMailboxRef","localUserId","_this2","RTCPeerConnection","addStream","onaddstream","evt","onicecandidate","candidate","createOffer","_this3","error","description","setLocalDescription","from","broadcastOfferToRemote","_this4","once","snap","forEach","snapshot","remoteNickname","key","remoteRef","listenerSelfMailbox","_this5","on","val","offer","JSON","parse","handleRemoteOffer","answer","handleRemoteAnswer","RTCIceCandidate","addIceCandidate","localStream","_this6","desc","RTCSessionDescription","setRemoteDescription","createAnswer","localDescription","_remoteState","init","created","replace","onDisconnect","remove","components","ChatView","__WEBPACK_IMPORTED_MODULE_1__App__","__WEBPACK_IMPORTED_MODULE_1__App___default","__WEBPACK_IMPORTED_MODULE_2__router__","productionTip","el","router","render","h","_vm","_h","$createElement","_self","_c","directives","rawName","expression","modifiers","trim","staticClass","attrs","placeholder","domProps","keyup","$event","_k","keyCode","input","target","composing","blur","$forceUpdate","staticRenderFns","_v","_s","id","autoplay","loadedmetadata"],"mappings":"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","file":"js/app.5a8942d4cb806aeb8a66.js","sourcesContent":["webpackJsonp([1],[\n/* 0 */,\n/* 1 */,\n/* 2 */,\n/* 3 */,\n/* 4 */,\n/* 5 */,\n/* 6 */,\n/* 7 */,\n/* 8 */,\n/* 9 */,\n/* 10 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_wilddog__ = __webpack_require__(64);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_wilddog___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_wilddog__);\n\nvar config = {\n  authDomain: 'vechat.wilddogio.com',\n  syncURL: 'https://vechat.wilddogio.com'\n};\n\n__WEBPACK_IMPORTED_MODULE_0_wilddog___default.a.initializeApp(config);\nvar Ref = __WEBPACK_IMPORTED_MODULE_0_wilddog___default.a.sync();\n/* harmony default export */ __webpack_exports__[\"a\"] = (Ref);\n\n/***/ }),\n/* 11 */,\n/* 12 */,\n/* 13 */,\n/* 14 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_vue__ = __webpack_require__(9);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_vue_router__ = __webpack_require__(60);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__pages_login_vue__ = __webpack_require__(54);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__pages_login_vue___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2__pages_login_vue__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__pages_room_vue__ = __webpack_require__(55);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__pages_room_vue___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3__pages_room_vue__);\n\n\n\n\n\n__WEBPACK_IMPORTED_MODULE_0_vue__[\"a\" /* default */].use(__WEBPACK_IMPORTED_MODULE_1_vue_router__[\"a\" /* default */]);\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (new __WEBPACK_IMPORTED_MODULE_1_vue_router__[\"a\" /* default */]({\n  routes: [{\n    path: '/',\n    name: 'Login',\n    component: __WEBPACK_IMPORTED_MODULE_2__pages_login_vue___default.a\n  }, {\n    path: '/room',\n    name: 'Room',\n    component: __WEBPACK_IMPORTED_MODULE_3__pages_room_vue___default.a\n  }]\n}));\n\n/***/ }),\n/* 15 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\n/* styles */\n__webpack_require__(42)\n\nvar Component = __webpack_require__(4)(\n  /* script */\n  __webpack_require__(18),\n  /* template */\n  __webpack_require__(58),\n  /* scopeId */\n  null,\n  /* cssModules */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n/***/ }),\n/* 16 */,\n/* 17 */,\n/* 18 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n\n\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\n  name: 'app',\n\n  data: function data() {\n    return {\n      room: '',\n      nickname: ''\n    };\n  }\n});\n\n/***/ }),\n/* 19 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n\n\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\n  props: {\n    stream: '',\n\n    width: {\n      type: Number,\n      default: 640\n    },\n\n    height: {\n      type: Number,\n      default: 480\n    }\n  },\n\n  computed: {\n    src: function src() {\n      if (!this.stream) return '';\n\n      return URL.createObjectURL(this.stream);\n    }\n  },\n\n  methods: {\n    loadedmetadataHandler: function loadedmetadataHandler() {\n      console.log(\"Label: \" + this.stream.label);\n      console.log(\"AudioTracks\", this.stream.getAudioTracks());\n      console.log(\"VideoTracks\", this.stream.getVideoTracks());\n    }\n  }\n});\n\n/***/ }),\n/* 20 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__wilddog_index_js__ = __webpack_require__(10);\n\n\n\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\n  data: function data() {\n    return {\n      nickname: '',\n      room: ''\n    };\n  },\n\n\n  methods: {\n    join: function join() {\n      var _this = this;\n\n      if (!this.room) return alert('亲~房间号！');\n      var app = this.$root.$children[0];\n      var nickname = Math.random().toString(16).substr(2);\n      app.nickname = nickname;\n      app.room = this.room;\n      __WEBPACK_IMPORTED_MODULE_0__wilddog_index_js__[\"a\" /* default */].child(this.room).child(nickname).set(Date.now(), function (err) {\n        if (!err) {\n          _this.$router.push({ name: 'Room' });\n        }\n      });\n    }\n  }\n});\n\n/***/ }),\n/* 21 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify__ = __webpack_require__(24);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__common_getApp_js__ = __webpack_require__(22);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__wilddog_index_js__ = __webpack_require__(10);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__components_chat_view_vue__ = __webpack_require__(53);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__components_chat_view_vue___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3__components_chat_view_vue__);\n\n\n\n\n\n\n\nvar ICE_SERVERS = {\n  'iceServers': [{\n    'url': 'stun:cn1-stun.wilddog.com:3478'\n  }]\n};\n\nfunction errHandler(err) {\n  console.log(err);\n}\n\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\n  mixins: [__WEBPACK_IMPORTED_MODULE_1__common_getApp_js__[\"a\" /* default */]],\n\n  data: function data() {\n    this.dog = __WEBPACK_IMPORTED_MODULE_2__wilddog_index_js__[\"a\" /* default */];\n\n    this.peer = null;\n    return {\n      selfStream: null,\n      userStream: null,\n      targetNickname: ''\n    };\n  },\n\n\n  methods: {\n    createLocalStream: function createLocalStream() {\n      var _this = this;\n\n      return navigator.mediaDevices.getUserMedia({\n        audio: true,\n        video: true\n      }).then(function (stream) {\n        _this.selfStream = stream;\n      }, function (err) {\n        console.log('GetUserMedia error: ', err);\n      });\n    },\n    createPeer: function createPeer(stream, remoteUserMailboxRef, localUserId) {\n      var _this2 = this;\n\n      if (stream == null) {\n        console.log('set peer: cannot get local stream');\n        return null;\n      }\n\n      var peer = new RTCPeerConnection(ICE_SERVERS);\n      this.peer = peer;\n\n      peer.addStream(stream, function (err) {\n        if (err) {\n          console.log('setPeer: add stream error code: ', err);\n        }\n      });\n\n      peer.onaddstream = function (evt) {\n        _this2.userStream = evt.stream;\n      };\n\n      peer.onicecandidate = function (evt) {\n        console.log('onicecandidate');\n        if (evt.candidate == null) {\n          return;\n        }\n        var candidate = {};\n        candidate['from'] = localUserId;\n        candidate['type'] = 'candidate';\n        candidate['value'] = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default()(evt.candidate);\n        remoteUserMailboxRef.push(candidate);\n      };\n      return peer;\n    },\n    createOffer: function createOffer(remoteUserMailboxRef, localUserId) {\n      var _this3 = this;\n\n      if (!this.peer) {\n        console.error('peer is null');\n        return;\n      }\n\n      this.peer.createOffer(function (description) {\n        _this3.peer.setLocalDescription(description, function (evt) {\n          remoteUserMailboxRef.push({\n            from: localUserId,\n            type: 'offer',\n            value: __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default()(description)\n          });\n        }, errHandler);\n      }, errHandler);\n    },\n    broadcastOfferToRemote: function broadcastOfferToRemote() {\n      var _this4 = this;\n\n      this.dog.once('value', function (snap) {\n        snap.forEach(function (snapshot) {\n          var remoteNickname = snapshot.key();\n          if (remoteNickname === _this4.nickname) return;\n          var remoteRef = _this4.dog.child(remoteNickname).child('mailbox');\n          _this4.createPeer(_this4.selfStream, remoteRef, _this4.nickname);\n          _this4.createOffer(remoteRef, _this4.nickname);\n        });\n      });\n    },\n    listenerSelfMailbox: function listenerSelfMailbox() {\n      var _this5 = this;\n\n      var dog = this.dog,\n          nickname = this.nickname,\n          selfStream = this.selfStream;\n\n      dog.child(nickname).child('mailbox').on('child_added', function (snapshot) {\n        if (snapshot.val() == null) {\n          return;\n        }\n\n        var remoteNickname = snapshot.child('from').val();\n        _this5.targetNickname = remoteNickname;\n\n        var type = snapshot.child('type').val();\n\n        if (type == 'offer') {\n          console.log('received offer');\n          var offer = JSON.parse(snapshot.child('value').val());\n          var remoteUserMailboxRef = dog.child(remoteNickname).child('mailbox');\n\n          _this5.handleRemoteOffer(remoteUserMailboxRef, nickname, offer, selfStream);\n          return;\n        }\n        if (type == 'answer') {\n          var answer = JSON.parse(snapshot.child('value').val());\n          console.log('received answer');\n\n          _this5.handleRemoteAnswer(answer, remoteNickname);\n          return;\n        }\n        if (type == 'candidate') {\n          console.log('received candidate');\n          var candidate = new RTCIceCandidate(JSON.parse(snapshot.child('value').val()));\n          if (_this5.peer != null) {\n            _this5.peer.addIceCandidate(candidate);\n          }\n        }\n      });\n    },\n    handleRemoteOffer: function handleRemoteOffer(remoteUserMailboxRef, localUserId, offer, localStream) {\n      var _this6 = this;\n\n      this.createPeer(localStream, remoteUserMailboxRef, localUserId);\n\n      var desc = new RTCSessionDescription(offer);\n\n      this.peer.setRemoteDescription(desc, function (err) {\n        _this6.peer.createAnswer(function (description) {\n          _this6.peer.setLocalDescription(description, function () {\n            var answer = {\n              from: localUserId,\n              type: 'answer',\n              value: __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default()(_this6.peer.localDescription)\n            };\n\n            remoteUserMailboxRef.push(answer);\n          }, function (err) {\n            console.log('setLocalDescription Failure callback: ' + err);\n          });\n        }, function (err) {\n          console.log('createAnswer Failure callback: ' + err);\n        });\n      }, function (err) {\n        console.log('setRemoteDescription Failure callback: ' + err);\n        _this6.peer._remoteState = 'failed';\n      });\n    },\n    handleRemoteAnswer: function handleRemoteAnswer(answer, remoteNickname) {\n      if (this.peer == null) {\n        console.log('local peer is null!');\n        return;\n      }\n\n      var description = new RTCSessionDescription(answer);\n\n      this.peer.setRemoteDescription(description, function () {\n        console.log('setRemoteDescription success');\n      }, function (err) {\n        console.log('setRemoteDescription err:', err);\n      });\n    },\n    init: function init() {\n      this.broadcastOfferToRemote();\n      this.listenerSelfMailbox();\n    }\n  },\n\n  created: function created() {\n    var nickname = this.nickname,\n        room = this.room;\n\n    if (!nickname || !room) {\n      this.$router.replace({ name: 'Login' });\n      return;\n    }\n    this.dog = __WEBPACK_IMPORTED_MODULE_2__wilddog_index_js__[\"a\" /* default */].child(room);\n    this.dog.child(nickname).onDisconnect().remove();\n    this.createLocalStream().then(this.init);\n  },\n\n\n  components: { ChatView: __WEBPACK_IMPORTED_MODULE_3__components_chat_view_vue___default.a }\n});\n\n/***/ }),\n/* 22 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony default export */ __webpack_exports__[\"a\"] = ({\n  computed: {\n    app: function app() {\n      return this.$root.$children[0];\n    },\n    nickname: function nickname() {\n      return this.app.nickname;\n    },\n    room: function room() {\n      return this.app.room;\n    }\n  }\n});\n\n/***/ }),\n/* 23 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_vue__ = __webpack_require__(9);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__App__ = __webpack_require__(15);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__App___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1__App__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__router__ = __webpack_require__(14);\n\n\n\n\n__WEBPACK_IMPORTED_MODULE_0_vue__[\"a\" /* default */].config.productionTip = false;\n\nnew __WEBPACK_IMPORTED_MODULE_0_vue__[\"a\" /* default */]({\n  el: '#app',\n  router: __WEBPACK_IMPORTED_MODULE_2__router__[\"a\" /* default */],\n  render: function render(h) {\n    return h(__WEBPACK_IMPORTED_MODULE_1__App___default.a);\n  }\n});\n\n/***/ }),\n/* 24 */,\n/* 25 */,\n/* 26 */,\n/* 27 */,\n/* 28 */,\n/* 29 */,\n/* 30 */,\n/* 31 */,\n/* 32 */,\n/* 33 */,\n/* 34 */,\n/* 35 */,\n/* 36 */,\n/* 37 */,\n/* 38 */,\n/* 39 */,\n/* 40 */\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n/* 41 */\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n/* 42 */\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n/* 43 */\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n/* 44 */,\n/* 45 */,\n/* 46 */,\n/* 47 */,\n/* 48 */,\n/* 49 */,\n/* 50 */,\n/* 51 */,\n/* 52 */,\n/* 53 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\n/* styles */\n__webpack_require__(43)\n\nvar Component = __webpack_require__(4)(\n  /* script */\n  __webpack_require__(19),\n  /* template */\n  __webpack_require__(59),\n  /* scopeId */\n  null,\n  /* cssModules */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n/***/ }),\n/* 54 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\n/* styles */\n__webpack_require__(40)\n\nvar Component = __webpack_require__(4)(\n  /* script */\n  __webpack_require__(20),\n  /* template */\n  __webpack_require__(56),\n  /* scopeId */\n  null,\n  /* cssModules */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n/***/ }),\n/* 55 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\n/* styles */\n__webpack_require__(41)\n\nvar Component = __webpack_require__(4)(\n  /* script */\n  __webpack_require__(21),\n  /* template */\n  __webpack_require__(57),\n  /* scopeId */\n  null,\n  /* cssModules */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n/***/ }),\n/* 56 */\n/***/ (function(module, exports) {\n\nmodule.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('input', {\n    directives: [{\n      name: \"model\",\n      rawName: \"v-model.trim\",\n      value: (_vm.room),\n      expression: \"room\",\n      modifiers: {\n        \"trim\": true\n      }\n    }],\n    staticClass: \"login-input\",\n    attrs: {\n      \"type\": \"text\",\n      \"placeholder\": \"请输入房间号\"\n    },\n    domProps: {\n      \"value\": (_vm.room)\n    },\n    on: {\n      \"keyup\": function($event) {\n        if (!('button' in $event) && _vm._k($event.keyCode, \"enter\", 13)) { return null; }\n        _vm.join($event)\n      },\n      \"input\": function($event) {\n        if ($event.target.composing) { return; }\n        _vm.room = $event.target.value.trim()\n      },\n      \"blur\": function($event) {\n        _vm.$forceUpdate()\n      }\n    }\n  })\n},staticRenderFns: []}\n\n/***/ }),\n/* 57 */\n/***/ (function(module, exports) {\n\nmodule.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('section', {\n    staticClass: \"page-room\"\n  }, [_c('div', {\n    staticClass: \"view-self\"\n  }, [_c('chat-view', {\n    attrs: {\n      \"stream\": _vm.selfStream\n    }\n  }), _vm._v(\" \"), _c('div', {\n    staticClass: \"info\"\n  }, [_c('span', [_vm._v(\"CHAT ROOM: \" + _vm._s(_vm.room))]), _vm._v(\" \"), _c('span', [_vm._v(\"NICKNAME: \" + _vm._s(_vm.nickname))]), _vm._v(\" \"), _c('span', [_vm._v(\"TARGET NICKNAME: \" + _vm._s(_vm.targetNickname))])])], 1), _vm._v(\" \"), _c('div', {\n    staticClass: \"view-other\"\n  }, [_c('chat-view', {\n    attrs: {\n      \"stream\": _vm.userStream\n    }\n  })], 1)])\n},staticRenderFns: []}\n\n/***/ }),\n/* 58 */\n/***/ (function(module, exports) {\n\nmodule.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('div', {\n    attrs: {\n      \"id\": \"app\"\n    }\n  }, [_c('router-view')], 1)\n},staticRenderFns: []}\n\n/***/ }),\n/* 59 */\n/***/ (function(module, exports) {\n\nmodule.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('video', {\n    staticClass: \"component-chat-view\",\n    attrs: {\n      \"autoplay\": \"\",\n      \"src\": _vm.src,\n      \"width\": \"width\",\n      \"height\": \"height\"\n    },\n    on: {\n      \"loadedmetadata\": _vm.loadedmetadataHandler\n    }\n  })\n},staticRenderFns: []}\n\n/***/ }),\n/* 60 */,\n/* 61 */,\n/* 62 */,\n/* 63 */,\n/* 64 */,\n/* 65 */\n/***/ (function(module, exports) {\n\n/* (ignored) */\n\n/***/ })\n],[23]);\n\n\n// WEBPACK FOOTER //\n// js/app.5a8942d4cb806aeb8a66.js","import wilddog from 'wilddog'\nconst config = {\n  authDomain: 'vechat.wilddogio.com',\n  syncURL: 'https://vechat.wilddogio.com'\n}\n\nwilddog.initializeApp(config)\nconst Ref = wilddog.sync()\nexport default Ref\n\n\n\n// WEBPACK FOOTER //\n// ./src/wilddog/index.js","import Vue from 'vue'\nimport Router from 'vue-router'\nimport Login from '@/pages/login.vue'\nimport Room from '@/pages/room.vue'\n\nVue.use(Router)\n\nexport default new Router({\n  routes: [\n    {\n      path: '/',\n      name: 'Login',\n      component: Login\n    },\n    {\n      path: '/room',\n      name: 'Room',\n      component: Room\n    }\n  ]\n})\n\n\n\n// WEBPACK FOOTER //\n// ./src/router/index.js","\n/* styles */\nrequire(\"!!../node_modules/extract-text-webpack-plugin/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"minimize\\\":true,\\\"sourceMap\\\":true}!../node_modules/vue-loader/lib/style-compiler/index?{\\\"id\\\":\\\"data-v-48ba03e6\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!../node_modules/vue-loader/lib/selector?type=styles&index=0!./App.vue\")\n\nvar Component = require(\"!../node_modules/vue-loader/lib/component-normalizer\")(\n  /* script */\n  require(\"!!babel-loader!../node_modules/vue-loader/lib/selector?type=script&index=0!./App.vue\"),\n  /* template */\n  require(\"!!../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-48ba03e6\\\"}!../node_modules/vue-loader/lib/selector?type=template&index=0!./App.vue\"),\n  /* scopeId */\n  null,\n  /* cssModules */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/App.vue\n// module id = 15\n// module chunks = 1","<template>\n  <div id=\"app\">\n    <router-view></router-view>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'app',\n\n  data () {\n    return {\n      room: '',\n      nickname: ''\n    }\n  }\n}\n</script>\n\n<style>\n* {\n  padding: 0;\n  margin: 0;\n  box-sizing: border-box;\n}\n\nhtml, body {\n  height: 100%;\n  width: 100%;\n}\n\n#app {\n  font-family: 'Avenir', Helvetica, Arial, sans-serif;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  text-align: center;\n  color: #2c3e50;\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  background: #000;\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// App.vue?7b567468","<template>\n  <video autoplay :src=\"src\"\n    class=\"component-chat-view\"\n    width=\"width\" height=\"height\"\n    @loadedmetadata=\"loadedmetadataHandler\">\n  </video>\n</template>\n\n<script>\nexport default {\n  props: {\n    stream: '',\n\n    width: {\n      type: Number,\n      default: 640\n    },\n\n    height: {\n      type: Number,\n      default: 480\n    }\n  },\n\n  computed: {\n    src () {\n      if (!this.stream) return ''\n      // URL.createObjectURL() 方法可以转换一个 MediaStream 到一个 Blog URL\n      return URL.createObjectURL(this.stream)\n    }\n  },\n\n  methods: {\n    loadedmetadataHandler () {\n      console.log(\"Label: \" + this.stream.label)\n      console.log(\"AudioTracks\", this.stream.getAudioTracks())\n      console.log(\"VideoTracks\", this.stream.getVideoTracks())\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\">\n.component-chat-view {\n  border: 3px solid #2c3e50;\n  width: 100%;\n  padding: 6px;\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// chat-view.vue?1ba149b6","<template>\n  <input type=\"text\"\n    placeholder=\"请输入房间号\"\n    class=\"login-input\"\n    v-model.trim=\"room\"\n    @keyup.enter=\"join\">\n</template>\n\n<script>\nimport Dog  from '@/wilddog/index.js'\nexport default {\n  data () {\n    return {\n      nickname: '',\n      room: ''\n    }\n  },\n\n  methods: {\n    join () {\n      if (!this.room) return alert('亲~房间号！')\n      const app = this.$root.$children[0]\n      const nickname = Math.random().toString(16).substr(2)\n      app.nickname = nickname\n      app.room = this.room\n      Dog.child(this.room).child(nickname).set(Date.now(), err => {\n        if (!err) {\n          this.$router.push({ name: 'Room' })\n        }\n      })\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\">\n.login-input {\n  display: block;\n  width: 500px;\n  height: 50px;\n  padding: 0 10px;\n  position: absolute;\n  top: 40%;\n  left: 50%;\n  margin-left: -250px;\n  font-size: 16px;\n  border: none;\n  color: #fff;\n  font-size: 18px;\n  font-weight: bold;\n  border-bottom: 3px solid #ccc;\n  background: transparent;\n\n  &:focus {\n    outline: none;\n  }\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// login.vue?42f3844e","<template>\n  <section class=\"page-room\">\n    <div class=\"view-self\">\n      <chat-view :stream=\"selfStream\"></chat-view>\n      <div class=\"info\">\n        <span>CHAT ROOM: {{ room }}</span>\n        <span>NICKNAME: {{ nickname }}</span>\n        <span>TARGET NICKNAME: {{ targetNickname }}</span>\n      </div>\n    </div>\n    <div class=\"view-other\">\n      <chat-view :stream=\"userStream\"></chat-view>\n    </div>\n  </section>\n</template>\n\n<script>\nimport GetApp from '@/common/getApp.js'\nimport Dog from '@/wilddog/index.js'\nimport ChatView from '@/components/chat-view.vue'\n\nconst ICE_SERVERS = {\n  'iceServers': [\n    {\n      'url': 'stun:cn1-stun.wilddog.com:3478'\n    }\n  ]\n}\n\nfunction errHandler (err) {\n  console.log(err)\n}\n\nexport default {\n  mixins: [GetApp],\n\n  data () {\n    this.dog = Dog\n    // 链接对象\n    this.peer = null\n    return {\n      selfStream: null,\n      userStream: null,\n      targetNickname: ''\n    }\n  },\n\n  methods: {\n    // 创建视频流数据\n    createLocalStream () {\n      return navigator.mediaDevices.getUserMedia({\n        audio: true,\n        video: true\n      }).then(stream => {\n        this.selfStream = stream\n      }, err => {\n        console.log('GetUserMedia error: ', err)\n      })\n    },\n\n\n    createPeer (stream, remoteUserMailboxRef, localUserId) {\n      if (stream == null) {\n        console.log('set peer: cannot get local stream')\n        return null\n      }\n\n      const peer = new RTCPeerConnection(ICE_SERVERS)\n      this.peer = peer\n\n      // 添加本地stream到要传输的的stream列表中\n      peer.addStream(stream, err => {\n        if (err) {\n          console.log('setPeer: add stream error code: ', err)\n        }\n      })\n      // 设置当收到对端stream时的回调\n      peer.onaddstream = evt => {\n        this.userStream = evt.stream\n      }\n\n      // 当收到底层ice candidate 消息，说明已经准备好了新的 candidate，发送给对端\n      peer.onicecandidate = function (evt) {\n        console.log('onicecandidate')\n        if (evt.candidate == null) { return }\n        const candidate = {}\n        candidate['from'] = localUserId\n        candidate['type'] = 'candidate'\n        candidate['value'] = JSON.stringify(evt.candidate)\n        remoteUserMailboxRef.push(candidate)\n      }\n      return peer\n    },\n\n    createOffer (remoteUserMailboxRef, localUserId) {\n      if (!this.peer) {\n        console.error('peer is null')\n        return\n      }\n      // 根据本地信息（媒体/ip等）创建offer，并发送到对端\n      this.peer.createOffer(description => {\n        // 创建出来的offer先在本地保存一份\n        this.peer.setLocalDescription(description, evt => {\n          // 发送到对端信箱\n          remoteUserMailboxRef.push({\n            from: localUserId,\n            type: 'offer',\n            value: JSON.stringify(description)\n          })\n        }, errHandler)\n      }, errHandler)\n    },\n\n    // 获取在线用户列表，广播自己的 offer\n    broadcastOfferToRemote () {\n      this.dog.once('value', snap => {\n        snap.forEach(snapshot => {\n          const remoteNickname = snapshot.key()\n          if (remoteNickname === this.nickname) return\n          const remoteRef = this.dog.child(remoteNickname).child('mailbox')\n          this.createPeer(this.selfStream, remoteRef, this.nickname)\n          this.createOffer(remoteRef, this.nickname)\n        })\n      })\n    },\n\n    // 监听自己信箱下是否有新信到来\n    listenerSelfMailbox () {\n      const { dog, nickname, selfStream } = this\n      dog.child(nickname).child('mailbox').on('child_added', snapshot => {\n        if (snapshot.val() == null) {\n          return\n        }\n\n        // 获取寄件人的id\n        const remoteNickname = snapshot.child('from').val()\n        this.targetNickname = remoteNickname\n\n        // 获取信的类型\n        const type = snapshot.child('type').val()\n\n        if (type == 'offer') {\n          // 收到对端的offer请求\n          console.log('received offer')\n          let offer = JSON.parse(snapshot.child('value').val())\n          let remoteUserMailboxRef = dog.child(remoteNickname).child('mailbox')\n          // 收到对端的一个连接请求，建立p2p连接，并将回复返回给对端\n          this.handleRemoteOffer(remoteUserMailboxRef, nickname, offer, selfStream)\n          return\n        }\n        if (type == 'answer') {\n          // 收到对端的answer响应\n          let answer = JSON.parse(snapshot.child('value').val())\n          console.log('received answer')\n            // 收到对端的响应，将对端的answer响应设置到本地\n          this.handleRemoteAnswer(answer, remoteNickname)\n          return\n        }\n        if (type == 'candidate') {\n          // 收到对端的candidate，设置到本地\n          console.log('received candidate')\n          let candidate = new RTCIceCandidate(JSON.parse(snapshot.child('value').val()))\n          if (this.peer != null) {\n            this.peer.addIceCandidate(candidate)\n          }\n        }\n      })\n    },\n\n    // 处理对端发出 Offer 请求\n    handleRemoteOffer (remoteUserMailboxRef, localUserId, offer, localStream) {\n      // 创建新的peer\n      this.createPeer(localStream, remoteUserMailboxRef, localUserId)\n\n      // 将对端的offer sdp 信息设置为 RTCSessionDescription 对象\n      const desc = new RTCSessionDescription(offer)\n\n      // 设置对端offer sdp到本地-->创建answer-->设置本地sdp-->发送answer\n      this.peer.setRemoteDescription(desc, err => {\n        this.peer.createAnswer(description => {\n          this.peer.setLocalDescription(description, () => {\n            const answer = {\n              from: localUserId,\n              type: 'answer',\n              value: JSON.stringify(this.peer.localDescription)\n            }\n            // 发送answer到对端信箱\n            remoteUserMailboxRef.push(answer)\n          }, err => {\n            console.log('setLocalDescription Failure callback: ' + err)\n          })\n        }, err => {\n          console.log('createAnswer Failure callback: ' + err)\n        })\n      }, err => {\n        console.log('setRemoteDescription Failure callback: ' + err)\n        this.peer._remoteState = 'failed'\n      })\n    },\n\n    // 处理对端的 Answer 请求\n    handleRemoteAnswer (answer, remoteNickname) {\n      if (this.peer == null) {\n        console.log('local peer is null!')\n        return\n      }\n\n      const description = new RTCSessionDescription(answer)\n      // 收到对端的answer，将其设置到本地\n      this.peer.setRemoteDescription(description, () => {\n        console.log('setRemoteDescription success')\n      }, err => {\n        console.log('setRemoteDescription err:', err)\n      })\n    },\n\n    init () {\n      this.broadcastOfferToRemote()\n      this.listenerSelfMailbox()\n    }\n  },\n\n  created () {\n    const { nickname, room } = this\n    if (!nickname || !room) {\n      this.$router.replace({ name: 'Login' })\n      return\n    }\n    this.dog = Dog.child(room)\n    this.dog.child(nickname).onDisconnect().remove()\n    this.createLocalStream().then(this.init)\n  },\n\n  components: { ChatView }\n}\n</script>\n\n<style lang=\"scss\">\n.page-room {\n  display: flex;\n  flex-wrap: wrap;\n  width: 100%;\n  padding: 10px;\n\n  .view-self {\n    flex: 1;\n    margin-right: 10px;\n  }\n\n  .view-other {\n    flex: 3;\n  }\n\n  .info {\n    margin-top: 20px;\n    padding: 10px;\n\n    span {\n      display: block;\n      height: 40px;\n      line-height: 40px;\n      text-align: left;\n    }\n  }\n}\n</style>\n\n\n\n\n// WEBPACK FOOTER //\n// room.vue?496d9526","export default {\n  computed: {\n    app () {\n      return this.$root.$children[0]\n    },\n\n    nickname () {\n      return this.app.nickname\n    },\n\n    room () {\n      return this.app.room\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/common/getApp.js","import Vue from 'vue'\nimport App from './App'\nimport router from './router'\n\nVue.config.productionTip = false\n\n/* eslint-disable no-new */\nnew Vue({\n  el: '#app',\n  router,\n  render: h => h(App)\n})\n\n\n\n// WEBPACK FOOTER //\n// ./src/main.js","\n/* styles */\nrequire(\"!!../../node_modules/extract-text-webpack-plugin/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"minimize\\\":true,\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"id\\\":\\\"data-v-87292ba8\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./chat-view.vue\")\n\nvar Component = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")(\n  /* script */\n  require(\"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./chat-view.vue\"),\n  /* template */\n  require(\"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-87292ba8\\\"}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./chat-view.vue\"),\n  /* scopeId */\n  null,\n  /* cssModules */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/chat-view.vue\n// module id = 53\n// module chunks = 1","\n/* styles */\nrequire(\"!!../../node_modules/extract-text-webpack-plugin/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"minimize\\\":true,\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"id\\\":\\\"data-v-090dafc3\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./login.vue\")\n\nvar Component = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")(\n  /* script */\n  require(\"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./login.vue\"),\n  /* template */\n  require(\"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-090dafc3\\\"}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./login.vue\"),\n  /* scopeId */\n  null,\n  /* cssModules */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/pages/login.vue\n// module id = 54\n// module chunks = 1","\n/* styles */\nrequire(\"!!../../node_modules/extract-text-webpack-plugin/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"minimize\\\":true,\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"id\\\":\\\"data-v-11fa1371\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./room.vue\")\n\nvar Component = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")(\n  /* script */\n  require(\"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./room.vue\"),\n  /* template */\n  require(\"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-11fa1371\\\"}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./room.vue\"),\n  /* scopeId */\n  null,\n  /* cssModules */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/pages/room.vue\n// module id = 55\n// module chunks = 1","module.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('input', {\n    directives: [{\n      name: \"model\",\n      rawName: \"v-model.trim\",\n      value: (_vm.room),\n      expression: \"room\",\n      modifiers: {\n        \"trim\": true\n      }\n    }],\n    staticClass: \"login-input\",\n    attrs: {\n      \"type\": \"text\",\n      \"placeholder\": \"请输入房间号\"\n    },\n    domProps: {\n      \"value\": (_vm.room)\n    },\n    on: {\n      \"keyup\": function($event) {\n        if (!('button' in $event) && _vm._k($event.keyCode, \"enter\", 13)) { return null; }\n        _vm.join($event)\n      },\n      \"input\": function($event) {\n        if ($event.target.composing) { return; }\n        _vm.room = $event.target.value.trim()\n      },\n      \"blur\": function($event) {\n        _vm.$forceUpdate()\n      }\n    }\n  })\n},staticRenderFns: []}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/vue-loader/lib/template-compiler?{\"id\":\"data-v-090dafc3\"}!./~/vue-loader/lib/selector.js?type=template&index=0!./src/pages/login.vue\n// module id = 56\n// module chunks = 1","module.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('section', {\n    staticClass: \"page-room\"\n  }, [_c('div', {\n    staticClass: \"view-self\"\n  }, [_c('chat-view', {\n    attrs: {\n      \"stream\": _vm.selfStream\n    }\n  }), _vm._v(\" \"), _c('div', {\n    staticClass: \"info\"\n  }, [_c('span', [_vm._v(\"CHAT ROOM: \" + _vm._s(_vm.room))]), _vm._v(\" \"), _c('span', [_vm._v(\"NICKNAME: \" + _vm._s(_vm.nickname))]), _vm._v(\" \"), _c('span', [_vm._v(\"TARGET NICKNAME: \" + _vm._s(_vm.targetNickname))])])], 1), _vm._v(\" \"), _c('div', {\n    staticClass: \"view-other\"\n  }, [_c('chat-view', {\n    attrs: {\n      \"stream\": _vm.userStream\n    }\n  })], 1)])\n},staticRenderFns: []}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/vue-loader/lib/template-compiler?{\"id\":\"data-v-11fa1371\"}!./~/vue-loader/lib/selector.js?type=template&index=0!./src/pages/room.vue\n// module id = 57\n// module chunks = 1","module.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('div', {\n    attrs: {\n      \"id\": \"app\"\n    }\n  }, [_c('router-view')], 1)\n},staticRenderFns: []}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/vue-loader/lib/template-compiler?{\"id\":\"data-v-48ba03e6\"}!./~/vue-loader/lib/selector.js?type=template&index=0!./src/App.vue\n// module id = 58\n// module chunks = 1","module.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('video', {\n    staticClass: \"component-chat-view\",\n    attrs: {\n      \"autoplay\": \"\",\n      \"src\": _vm.src,\n      \"width\": \"width\",\n      \"height\": \"height\"\n    },\n    on: {\n      \"loadedmetadata\": _vm.loadedmetadataHandler\n    }\n  })\n},staticRenderFns: []}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/vue-loader/lib/template-compiler?{\"id\":\"data-v-87292ba8\"}!./~/vue-loader/lib/selector.js?type=template&index=0!./src/components/chat-view.vue\n// module id = 59\n// module chunks = 1"],"sourceRoot":""}